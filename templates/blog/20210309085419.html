<h2>シフト演算子</h2>

C言語のシフト演算子について解説します。シフト演算は、ビット位置を右あるいは、左に移動させる演算のことです。

C言語仕様上では、定義されていませんが、デファクトスタンダードとして、論理シフト演算は、符号なし整数に対して、算術シフト演算は、符号あり整数に対して実装されていると想定してください。VC++や<a href="https://linux.perlzemi.com/blog/20201216103956.html">gcc</a>はどちらもこの動作をします。

ただし、これは処理系依存ですので、動かない処理系がある可能性はありますが、このように実装しない限り、C言語で論理シフト演算と算術シフト演算を定義できず、移植性のあるライブラリを書けないので、時間がたつにつれて、デファクトスタンダード側の実装で、そろうと想像します。

このような前提に立ちつつ、解説をします。

<h3>左論理シフト演算</h3>

左論理シフト演算は、指定した回数、左に論理シフトさせます。xは、符号なし整数です。

<pre>
// 左論理シフト演算
x << count
</pre>

値が<a href="/blog/20201122084622.html">符号なし8bit整数</a>であるとします。これを2bit左へシフト演算すると、次のようになります。8bitを超えた部分は、切り捨てられます。右側は0で埋められます。

<pre>
// これを左へ2bitシフトさせると
  10101101

// このようになる
10101101

// 8bitを超えた部分は切り捨て、右側は0で埋めます
  10110100
</pre>

左論理シフト演算のサンプルプログラムです。

<pre>
#include <stdio.h>
#include <stdint.h>

int main(void) {
  // 10101101
  uint8_t x = 0xAD;
  
  // 2bit左論理シフト
  uint8_t y = x << 2;
  
  printf("%X\n", y);
}
</pre>

出力結果です。2進数にすると「10110100」です。

<pre>
B4
</pre>

<h3>右論理シフト演算</h3>

右論理シフト演算は、指定した回数、右に論理シフトさせます。xは、符号なし整数です。

<pre>
// 右論理シフト演算
x << count
</pre>

値が<a href="/blog/20201122084622.html">符号なし8bit整数</a>であるとします。これを2bit右へシフト演算すると、次のようになります。1bitより下の部分は、切り捨てられます。左側は0で埋められます。

<pre>
// これを右へ2bitシフトさせると
10101101

// このようになる
  10101101

// 1bitより下の部分は切り捨て、左側は0で埋めます
00101011
</pre>

右論理シフト演算のサンプルプログラムです。

<pre>
#include <stdio.h>
#include <stdint.h>

int main(void) {
  // 10101101
  uint8_t x = 0xAD;
  
  // 2bit右論理シフト
  uint8_t y = x >> 2;
  
  printf("%X\n", y);
}
</pre>

出力結果です。2進数にすると「00101011」です。

<pre>
2B
</pre>

(書き換え、算術シフトを追加予定)
